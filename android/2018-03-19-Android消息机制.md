# Android消息机制

| tag     | author     | date       | history    |
| ------- | ---------- | ---------- | ---------- |
| Android | caizhenghe | 2018-03-18 | create doc |
|         |            |            |            |

| 版本/状态 | 责任人 | 起止日期   | 备注                           |
| --------- | ------ | ---------- | ------------------------------ |
| V1.0/草稿 | 蔡政和 | 2018-03-18 | 创建消息机制文档               |
| V1.0/草稿 | 蔡政和 | 2019-01-24 | 更新文档，补充MessageQueue章节 |

## Handler

### 概要

Handler用于线程间的消息传递，它可以将一个线程中的任务切换到另一个线程执行。切换的目标线程与Handler内部持有的**Looper所在线程**一致。若初始化Handler时未手动设置Looper，Handler会通过ThreadLocal获取并持有当前（初始化Handler时）线程的Looper。当Handler发送一条消息后，这条消息会进入目标线程的MessageQueue，目标线程的Looper扫描并且取出这条消息，最终由Handler执行这条消息。通过这种方式实现跨线程处理消息的机制。



### 构造器

### sendMessageAtTime

### dispatchMessage

## ThreadLocal

## Looper

## MessageQueue

### IdleHandler

### AsycMessage和SyncBarrier

### 睡眠和唤醒机制

## Handler内存泄漏分析

## EventBus